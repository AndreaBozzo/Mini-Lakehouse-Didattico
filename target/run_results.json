{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2025-06-30T14:01:35.724511Z", "invocation_id": "defc6e95-8784-4d84-a2fa-ac7939cf5af9", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-30T14:01:33.169788Z", "completed_at": "2025-06-30T14:01:33.195518Z"}, {"name": "execute", "started_at": "2025-06-30T14:01:33.199462Z", "completed_at": "2025-06-30T14:01:33.369964Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3181636333465576, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.mini_lakehouse.stg_bilanci_comuni", "compiled": true, "compiled_code": "\n\nSELECT\n  codice_comune,\n  nome_comune,\n  anno,\n  entrate_tributarie,\n  spese_correnti,\n  entrate_tributarie - spese_correnti AS saldo\nFROM \"warehouse\".\"main\".\"raw_bilanci_comunali\"", "relation_name": "\"warehouse\".\"main_stg_simulated\".\"stg_bilanci_comuni\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-30T14:01:33.479199Z", "completed_at": "2025-06-30T14:01:33.490870Z"}, {"name": "execute", "started_at": "2025-06-30T14:01:33.494700Z", "completed_at": "2025-06-30T14:01:33.632916Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23836469650268555, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.mini_lakehouse.stg_movimenti_bilancio", "compiled": true, "compiled_code": "\n\nSELECT\n  codice_comune,\n  nome_comune,\n  anno,\n  codice_siope,\n  descrizione_siope\nFROM \"warehouse\".\"main\".\"raw_bilanci_voci\"", "relation_name": "\"warehouse\".\"main_stg_simulated\".\"stg_movimenti_bilancio\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-30T14:01:33.764067Z", "completed_at": "2025-06-30T14:01:33.791066Z"}, {"name": "execute", "started_at": "2025-06-30T14:01:33.793925Z", "completed_at": "2025-06-30T14:01:34.202590Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6059086322784424, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.mini_lakehouse.core_bilanci_comuni", "compiled": true, "compiled_code": "-- File: dbt/models/core/simulated/core_bilanci_comuni.sql\n\n\nSELECT\n    md5(cast(coalesce(cast(codice_comune as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(anno as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id_hash,\n    CAST(codice_comune AS INT) AS codice_comune,\n    CAST(nome_comune AS TEXT) AS nome_comune,\n    CAST(anno AS INT) AS anno,\n    CAST(entrate_tributarie AS BIGINT) AS entrate_tributarie,\n    CAST(spese_correnti AS BIGINT) AS spese_correnti,\n\n    -- Flag se valori critici sono null\n    CASE \n        WHEN entrate_tributarie IS NULL OR spese_correnti IS NULL THEN TRUE\n        ELSE FALSE\n    END AS flag_dato_incompleto,\n\n    -- Indicatore euristico qualit\u00e0 (semplificato per coerenza col mart)\n    100\n    - 50 * CASE WHEN entrate_tributarie IS NULL THEN 1 ELSE 0 END\n    - 50 * CASE WHEN spese_correnti IS NULL THEN 1 ELSE 0 END\n    AS indicatore_affidabilita\n\nFROM \"warehouse\".\"main_stg_simulated\".\"stg_bilanci_comuni\"\nWHERE \n    codice_comune IS NOT NULL\n    AND anno IS NOT NULL", "relation_name": "\"warehouse\".\"main_main_core\".\"core_bilanci_comuni\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-30T14:01:34.375648Z", "completed_at": "2025-06-30T14:01:34.387254Z"}, {"name": "execute", "started_at": "2025-06-30T14:01:34.390104Z", "completed_at": "2025-06-30T14:01:34.473637Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2021780014038086, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.mini_lakehouse.core_movimenti_bilancio", "compiled": true, "compiled_code": "\n\nSELECT\n  codice_comune,\n  nome_comune,\n  anno,\n  codice_siope AS tipologia,\n  descrizione_siope AS descrizione\nFROM \"warehouse\".\"main_stg_simulated\".\"stg_movimenti_bilancio\"", "relation_name": "\"warehouse\".\"main_core_simulated\".\"core_movimenti_bilancio\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-30T14:01:34.592035Z", "completed_at": "2025-06-30T14:01:34.602205Z"}, {"name": "execute", "started_at": "2025-06-30T14:01:34.605378Z", "completed_at": "2025-06-30T14:01:34.804295Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.35721874237060547, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.mini_lakehouse.fact_bilanci_comunali", "compiled": true, "compiled_code": "-- File: dbt/models/marts/simulated/fact_bilanci_comunali.sql\n\n\nSELECT\n    codice_comune,\n    nome_comune,\n    anno,\n\n    SUM(entrate_tributarie) AS totale_entrate,\n    SUM(spese_correnti) AS totale_spese,\n    SUM(entrate_tributarie - spese_correnti) AS saldo,\n\n    -- Propagazione flag: almeno una riga con flag attivo\n    BOOL_OR(flag_dato_incompleto) AS flag_dato_incompleto,\n\n    -- Media affidabilit\u00e0 sulle righe aggregate\n    ROUND(AVG(indicatore_affidabilita), 2) AS indicatore_affidabilita\n\nFROM \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nGROUP BY codice_comune, nome_comune, anno\nORDER BY anno, codice_comune", "relation_name": "\"warehouse\".\"main_main_marts_simulated\".\"fact_bilanci_comunali\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-30T14:01:34.957741Z", "completed_at": "2025-06-30T14:01:34.957741Z"}, {"name": "execute", "started_at": "2025-06-30T14:01:34.957741Z", "completed_at": "2025-06-30T14:01:35.060248Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.24415016174316406, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.mini_lakehouse.mart_finanza_locale", "compiled": true, "compiled_code": "-- File: dbt/models/marts/simulated/mart_finanza_locale.sql\n\n\nwith bilanci as (\n\n    select\n        codice_comune,\n        nome_comune,\n        anno,\n        entrate_tributarie,\n        spese_correnti,\n        entrate_tributarie - spese_correnti as saldo\n    from \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\n\n),\n\naudit as (\n\n    select\n        codice_comune,\n        anno,\n        flag_var_entrate,\n        flag_var_spese,\n        flag_saldo_negativo,\n        flag_valori_nulli,\n        flag_var_entrate or flag_var_spese or flag_saldo_negativo or flag_valori_nulli as flag_anomalia\n    from \"warehouse\".\"main\".\"core_audit_flags\"\n\n),\n\nfinale as (\n\n    select\n        b.codice_comune,\n        b.nome_comune,\n        b.anno,\n        b.entrate_tributarie,\n        b.spese_correnti,\n        b.saldo,\n        coalesce(a.flag_anomalia, false) as flag_anomalia\n    from bilanci b\n    left join audit a\n      on b.codice_comune = a.codice_comune\n     and b.anno = a.anno\n\n)\n\nselect * from finale", "relation_name": "\"warehouse\".\"main_main_marts_simulated\".\"mart_finanza_locale\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-30T14:01:35.215816Z", "completed_at": "2025-06-30T14:01:35.229537Z"}, {"name": "execute", "started_at": "2025-06-30T14:01:35.231536Z", "completed_at": "2025-06-30T14:01:35.490618Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.45438098907470703, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.mini_lakehouse.agg_entrate_per_categoria", "compiled": true, "compiled_code": "-- File: dbt/models/marts/simulated/agg_entrate_per_categoria.sql\n\n\nwith joined as (\n    select\n        mv.codice_comune,\n        mv.anno,\n        mv.tipologia    as categoria,\n        mv.descrizione  as descrizione,\n        cb.entrate_tributarie\n    from \"warehouse\".\"main_core_simulated\".\"core_movimenti_bilancio\" as mv\n    join \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\" as cb\n      on mv.codice_comune = cb.codice_comune\n     and mv.anno = cb.anno\n)\n\nselect\n    categoria,\n    descrizione,\n    count(*)                as numero_movimenti,\n    sum(entrate_tributarie) as totale_entrate\nfrom joined\ngroup by categoria, descrizione\norder by totale_entrate desc", "relation_name": "\"warehouse\".\"main_main_marts_simulated\".\"agg_entrate_per_categoria\""}], "elapsed_time": 4.156436920166016, "args": {"strict_mode": false, "use_colors_file": true, "select": ["tag:simulated"], "send_anonymous_usage_stats": true, "log_level": "info", "defer": false, "write_json": true, "project_dir": "C:\\Users\\Andrea\\Documents\\Mini Lakehouse Didattico", "warn_error_options": {"include": [], "exclude": []}, "favor_state": false, "exclude": [], "log_file_max_bytes": 10485760, "cache_selected_only": false, "which": "run", "macro_debugging": false, "show_resource_report": false, "profiles_dir": "C:\\Users\\Andrea\\.dbt", "vars": {}, "printer_width": 80, "partial_parse": true, "use_colors": true, "enable_legacy_logger": false, "introspect": true, "invocation_command": "dbt run --select tag:simulated", "quiet": false, "log_format_file": "debug", "version_check": true, "indirect_selection": "eager", "print": true, "log_format": "default", "partial_parse_file_diff": true, "populate_cache": true, "log_path": "C:\\Users\\Andrea\\Documents\\Mini Lakehouse Didattico\\logs", "log_level_file": "debug", "static_parser": true}}