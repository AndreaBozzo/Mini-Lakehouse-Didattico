{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-06-23T15:32:41.129126Z", "invocation_id": "e53ac2f5-c9d5-4f22-9ac0-886e0ba0de68", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.216683Z", "completed_at": "2025-06-23T15:32:40.226687Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.242315Z", "completed_at": "2025-06-23T15:32:40.242315Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02563190460205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.main_seeds.bilanci_comunali_sample", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.242315Z", "completed_at": "2025-06-23T15:32:40.242315Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.242315Z", "completed_at": "2025-06-23T15:32:40.242315Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.main_seeds.bilanci_voci_sample", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.257941Z", "completed_at": "2025-06-23T15:32:40.257941Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.257941Z", "completed_at": "2025-06-23T15:32:40.257941Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625476837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.raw_bilanci_comunali", "compiled": true, "compiled_code": "\n\nSELECT\n  codice_comune,\n  -- Title-case \u201cRoma\u201d \u2192 \u201cRoma\u201d, \u201cmilano\u201d \u2192 \u201cMilano\u201d\n  upper(substring(nome_comune, 1, 1))\n    || lower(substring(nome_comune, 2)) AS nome_comune,\n  anno,\n  entrate_tributarie,\n  spese_correnti\nFROM \"warehouse\".\"main_seeds\".\"bilanci_comunali_sample\"", "relation_name": "\"warehouse\".\"main\".\"raw_bilanci_comunali\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.273567Z", "completed_at": "2025-06-23T15:32:40.273567Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.273567Z", "completed_at": "2025-06-23T15:32:40.273567Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.raw_bilanci_voci", "compiled": true, "compiled_code": "\n\nSELECT\n  codice_comune,\n  nome_comune,\n  anno,\n  codice_siope,\n  descrizione_siope\nFROM \"warehouse\".\"main_seeds\".\"bilanci_voci_sample\"", "relation_name": "\"warehouse\".\"main\".\"raw_bilanci_voci\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.289191Z", "completed_at": "2025-06-23T15:32:40.289191Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.304816Z", "completed_at": "2025-06-23T15:32:40.304816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624761581420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.stg_bilanci_comuni", "compiled": true, "compiled_code": "\n\nSELECT\n  codice_comune,\n  nome_comune,\n  anno,\n  entrate_tributarie,\n  spese_correnti,\n  entrate_tributarie - spese_correnti AS saldo\nFROM \"warehouse\".\"main\".\"raw_bilanci_comunali\"", "relation_name": "\"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.304816Z", "completed_at": "2025-06-23T15:32:40.320453Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.320453Z", "completed_at": "2025-06-23T15:32:40.320453Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015636920928955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.stg_movimenti_bilancio", "compiled": true, "compiled_code": "\n\nSELECT\n  codice_comune,\n  nome_comune,\n  anno,\n  codice_siope,\n  descrizione_siope\nFROM \"warehouse\".\"main\".\"raw_bilanci_voci\"", "relation_name": "\"warehouse\".\"main_stg\".\"stg_movimenti_bilancio\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.326968Z", "completed_at": "2025-06-23T15:32:40.358234Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.358234Z", "completed_at": "2025-06-23T15:32:40.358234Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0377812385559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.core_bilanci_comuni", "compiled": true, "compiled_code": "\n\nSELECT\n    md5(cast(coalesce(cast(codice_comune as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(anno as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id_hash,\n    CAST(codice_comune AS INT) AS codice_comune,\n    nome_comune,\n    CAST(anno AS INT) AS anno,\n    CAST(entrate_tributarie AS BIGINT) AS entrate_tributarie,\n    CAST(spese_correnti AS BIGINT) AS spese_correnti,\n\n    -- Flag se valori critici sono null\n    CASE \n        WHEN entrate_tributarie IS NULL OR spese_correnti IS NULL THEN TRUE\n        ELSE FALSE\n    END AS flag_dato_incompleto,\n\n    -- Indicatore euristico qualit\u00e0 (semplificato per coerenza col mart)\n    100\n    - 50 * CASE WHEN entrate_tributarie IS NULL THEN 1 ELSE 0 END\n    - 50 * CASE WHEN spese_correnti IS NULL THEN 1 ELSE 0 END\n    AS indicatore_affidabilita\n\nFROM \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nWHERE \n    codice_comune IS NOT NULL\n    AND anno IS NOT NULL", "relation_name": "\"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.358234Z", "completed_at": "2025-06-23T15:32:40.389474Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.389474Z", "completed_at": "2025-06-23T15:32:40.389474Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031239748001098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_anno.a19cd8463e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect anno\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere anno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.405098Z", "completed_at": "2025-06-23T15:32:40.405098Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.420724Z", "completed_at": "2025-06-23T15:32:40.420724Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562643051147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_codice_comune.2f8b871ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect codice_comune\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere codice_comune is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.427231Z", "completed_at": "2025-06-23T15:32:40.427231Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.442863Z", "completed_at": "2025-06-23T15:32:40.442863Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02213883399963379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_entrate_tributarie.4e6a97484e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect entrate_tributarie\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere entrate_tributarie is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.442863Z", "completed_at": "2025-06-23T15:32:40.458486Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.458486Z", "completed_at": "2025-06-23T15:32:40.458486Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015623331069946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_nome_comune.581593d156", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nome_comune\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere nome_comune is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.474111Z", "completed_at": "2025-06-23T15:32:40.474111Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.489736Z", "completed_at": "2025-06-23T15:32:40.489736Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0312497615814209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_saldo.17a4bbd521", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect saldo\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere saldo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.489736Z", "completed_at": "2025-06-23T15:32:40.505361Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.520987Z", "completed_at": "2025-06-23T15:32:40.520987Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031250953674316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_spese_correnti.ca2af9ffe3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect spese_correnti\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere spese_correnti is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.527494Z", "completed_at": "2025-06-23T15:32:40.527494Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.527494Z", "completed_at": "2025-06-23T15:32:40.527494Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006507158279418945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.core_movimenti_bilancio", "compiled": true, "compiled_code": "\n\nSELECT\n  codice_comune,\n  nome_comune,\n  anno,\n  codice_siope AS tipologia,\n  descrizione_siope AS descrizione\nFROM \"warehouse\".\"main_stg\".\"stg_movimenti_bilancio\"", "relation_name": "\"warehouse\".\"main_core\".\"core_movimenti_bilancio\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.543124Z", "completed_at": "2025-06-23T15:32:40.558750Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.558750Z", "completed_at": "2025-06-23T15:32:40.558750Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562643051147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.audit_base", "compiled": true, "compiled_code": "SELECT\n    codice_comune,\n    anno,\n    COUNT(*) AS n_righe\nFROM \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nGROUP BY codice_comune, anno\nHAVING COUNT(*) > 1\nORDER BY n_righe DESC", "relation_name": "\"warehouse\".\"main\".\"audit_base\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.574374Z", "completed_at": "2025-06-23T15:32:40.589999Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.589999Z", "completed_at": "2025-06-23T15:32:40.589999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031248807907104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.core_audit_flags", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select\n        codice_comune,\n        nome_comune,\n        anno,\n        entrate_tributarie,\n        spese_correnti,\n        entrate_tributarie - spese_correnti as saldo\n    from \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\n\n),\n\nlagged as (\n\n    select\n        codice_comune,\n        nome_comune,\n        anno,\n        entrate_tributarie,\n        spese_correnti,\n        saldo,\n        lag(entrate_tributarie) over (partition by codice_comune order by anno) as entrate_anno_prec,\n        lag(spese_correnti) over (partition by codice_comune order by anno) as spese_anno_prec\n    from base\n\n),\n\naudit as (\n\n    select\n        codice_comune,\n        nome_comune,\n        anno,\n        entrate_tributarie,\n        spese_correnti,\n        saldo,\n        entrate_anno_prec,\n        spese_anno_prec,\n        \n    case\n        when entrate_anno_prec is null then false\n        when abs(entrate_tributarie - entrate_anno_prec) / nullif(entrate_anno_prec, 0) > 0.5 then true\n        else false\n    end\n as flag_var_entrate,\n        \n    case\n        when spese_anno_prec is null then false\n        when abs(spese_correnti - spese_anno_prec) / nullif(spese_anno_prec, 0) > 0.5 then true\n        else false\n    end\n as flag_var_spese,\n\n        case when saldo < 0 then true else false end as flag_saldo_negativo,\n        case when entrate_tributarie is null or spese_correnti is null then true else false end as flag_valori_nulli\n    from lagged\n\n)\n\nselect * from audit", "relation_name": "\"warehouse\".\"main\".\"core_audit_flags\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.605624Z", "completed_at": "2025-06-23T15:32:40.605624Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.605624Z", "completed_at": "2025-06-23T15:32:40.605624Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625476837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.fact_bilanci_comunali", "compiled": true, "compiled_code": "\n\nSELECT\n    codice_comune,\n    nome_comune,\n    anno,\n\n    SUM(entrate_tributarie) AS totale_entrate,\n    SUM(spese_correnti) AS totale_spese,\n    SUM(entrate_tributarie - spese_correnti) AS saldo,\n\n    -- Propagazione flag: almeno una riga con flag attivo\n    BOOL_OR(flag_dato_incompleto) AS flag_dato_incompleto,\n\n    -- Media affidabilit\u00e0 sulle righe aggregate\n    ROUND(AVG(indicatore_affidabilita), 2) AS indicatore_affidabilita\n\nFROM \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nGROUP BY codice_comune, nome_comune, anno\nORDER BY anno, codice_comune", "relation_name": "\"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.621250Z", "completed_at": "2025-06-23T15:32:40.627757Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.627757Z", "completed_at": "2025-06-23T15:32:40.627757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02213311195373535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.accepted_values_core_bilanci_comuni_flag_dato_incompleto__True__False.4473c02e5d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        flag_dato_incompleto as value_field,\n        count(*) as n_records\n\n    from \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\n    group by flag_dato_incompleto\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'True','False'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.643389Z", "completed_at": "2025-06-23T15:32:40.643389Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.643389Z", "completed_at": "2025-06-23T15:32:40.643389Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.check_anno_range", "compiled": true, "compiled_code": "-- tests/core/check_anno_range.sql\nWITH invalid AS (\n  SELECT * \n  FROM \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\n  WHERE anno < 1900\n    OR anno > EXTRACT(year FROM CURRENT_TIMESTAMP)\n)\nSELECT * FROM invalid", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.659022Z", "completed_at": "2025-06-23T15:32:40.659022Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.674647Z", "completed_at": "2025-06-23T15:32:40.674647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624284744262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.check_entrate_non_negative", "compiled": true, "compiled_code": "-- tests/core/check_entrate_non_negative.sql\nWITH invalid AS (\n  SELECT *\n  FROM \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\n  WHERE entrate_tributarie < 0\n)\nSELECT * FROM invalid", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.674647Z", "completed_at": "2025-06-23T15:32:40.674647Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.674647Z", "completed_at": "2025-06-23T15:32:40.674647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.check_spese_non_negative", "compiled": true, "compiled_code": "-- tests/core/check_spese_non_negative.sql\nWITH invalid AS (\n  SELECT *\n  FROM \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\n  WHERE spese_correnti < 0\n)\nSELECT * FROM invalid", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.690273Z", "completed_at": "2025-06-23T15:32:40.705898Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.705898Z", "completed_at": "2025-06-23T15:32:40.705898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0156252384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_anno.78df115c14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect anno\nfrom \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nwhere anno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.705898Z", "completed_at": "2025-06-23T15:32:40.721522Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.721522Z", "completed_at": "2025-06-23T15:32:40.721522Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015623807907104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_codice_comune.9d6e36b0ed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect codice_comune\nfrom \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nwhere codice_comune is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.728028Z", "completed_at": "2025-06-23T15:32:40.743667Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.743667Z", "completed_at": "2025-06-23T15:32:40.743667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015639543533325195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_entrate_tributarie.3fc83b6ce0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect entrate_tributarie\nfrom \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nwhere entrate_tributarie is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.743667Z", "completed_at": "2025-06-23T15:32:40.759293Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.759293Z", "completed_at": "2025-06-23T15:32:40.759293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625476837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_flag_dato_incompleto.f1850e841d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect flag_dato_incompleto\nfrom \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nwhere flag_dato_incompleto is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.759293Z", "completed_at": "2025-06-23T15:32:40.774917Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.774917Z", "completed_at": "2025-06-23T15:32:40.774917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624523162841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_id_hash.bc46054662", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id_hash\nfrom \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nwhere id_hash is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.774917Z", "completed_at": "2025-06-23T15:32:40.790542Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.790542Z", "completed_at": "2025-06-23T15:32:40.790542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_indicatore_affidabilita.f1b7971546", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect indicatore_affidabilita\nfrom \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nwhere indicatore_affidabilita is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.790542Z", "completed_at": "2025-06-23T15:32:40.806167Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.806167Z", "completed_at": "2025-06-23T15:32:40.806167Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0156252384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_nome_comune.d65879313b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nome_comune\nfrom \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nwhere nome_comune is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.821792Z", "completed_at": "2025-06-23T15:32:40.828308Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.828308Z", "completed_at": "2025-06-23T15:32:40.828308Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022140026092529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_spese_correnti.04bf1b85ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect spese_correnti\nfrom \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nwhere spese_correnti is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.828308Z", "completed_at": "2025-06-23T15:32:40.843946Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.843946Z", "completed_at": "2025-06-23T15:32:40.843946Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01563882827758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.test_core_bilanci_comuni", "compiled": true, "compiled_code": "-- tests/core/test_core_bilanci_comuni.sql\n-- Fallisce se la tabella core_bilanci_comuni \u00e8 vuota\nSELECT 1 AS error\nWHERE NOT EXISTS (\n  SELECT 1 FROM \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\n)", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.843946Z", "completed_at": "2025-06-23T15:32:40.859571Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.859571Z", "completed_at": "2025-06-23T15:32:40.859571Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.test_indicatore_affidabilita_range", "compiled": true, "compiled_code": "-- tests/core/test_indicatore_affidabilita_range.sql\nSELECT *\nFROM \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nWHERE indicatore_affidabilita < 0\n   OR indicatore_affidabilita > 100", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.859571Z", "completed_at": "2025-06-23T15:32:40.890813Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.890813Z", "completed_at": "2025-06-23T15:32:40.890813Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031241416931152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.unique_core_bilanci_comuni_id_hash.101f0dcd65", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id_hash as unique_field,\n    count(*) as n_records\n\nfrom \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\nwhere id_hash is not null\ngroup by id_hash\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.890813Z", "completed_at": "2025-06-23T15:32:40.906446Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.906446Z", "completed_at": "2025-06-23T15:32:40.906446Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015633106231689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.agg_entrate_per_categoria", "compiled": true, "compiled_code": "\n\nwith joined as (\n    select\n        mv.codice_comune,\n        mv.anno,\n        mv.tipologia    as categoria,\n        mv.descrizione  as descrizione,\n        cb.entrate_tributarie\n    from \"warehouse\".\"main_core\".\"core_movimenti_bilancio\" as mv\n    join \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\" as cb\n      on mv.codice_comune = cb.codice_comune\n     and mv.anno = cb.anno\n)\n\nselect\n    categoria,\n    descrizione,\n    count(*)               as numero_movimenti,\n    sum(entrate_tributarie) as totale_entrate\nfrom joined\ngroup by categoria, descrizione\norder by totale_entrate desc", "relation_name": "\"warehouse\".\"main_marts\".\"agg_entrate_per_categoria\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.906446Z", "completed_at": "2025-06-23T15:32:40.922070Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.922070Z", "completed_at": "2025-06-23T15:32:40.922070Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624523162841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.mart_audit_log", "compiled": true, "compiled_code": "\n\nwith audit as (\n\n    select *\n    from \"warehouse\".\"main\".\"core_audit_flags\"\n\n),\n\nanomalie as (\n\n    select *\n    from audit\n    where\n        flag_var_entrate = true\n        or flag_var_spese = true\n        or flag_saldo_negativo = true\n        or flag_valori_nulli = true\n\n)\n\nselect * from anomalie", "relation_name": "\"warehouse\".\"main\".\"mart_audit_log\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.928576Z", "completed_at": "2025-06-23T15:32:40.928576Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.928576Z", "completed_at": "2025-06-23T15:32:40.928576Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.mart_finanza_locale", "compiled": true, "compiled_code": "\n\nwith bilanci as (\n\n    select\n        codice_comune,\n        nome_comune,\n        anno,\n        entrate_tributarie,\n        spese_correnti,\n        entrate_tributarie - spese_correnti as saldo\n    from \"warehouse\".\"main_main_core\".\"core_bilanci_comuni\"\n\n),\n\naudit as (\n\n    select\n        codice_comune,\n        anno,\n        flag_var_entrate,\n        flag_var_spese,\n        flag_saldo_negativo,\n        flag_valori_nulli,\n        -- almeno una anomalia\n        flag_var_entrate or flag_var_spese or flag_saldo_negativo or flag_valori_nulli as flag_anomalia\n    from \"warehouse\".\"main\".\"core_audit_flags\"\n\n),\n\nfinale as (\n\n    select\n        b.codice_comune,\n        b.nome_comune,\n        b.anno,\n        b.entrate_tributarie,\n        b.spese_correnti,\n        b.saldo,\n        coalesce(a.flag_anomalia, false) as flag_anomalia\n    from bilanci b\n    left join audit a\n      on b.codice_comune = a.codice_comune\n     and b.anno = a.anno\n\n)\n\nselect * from finale", "relation_name": "\"warehouse\".\"main_marts\".\"mart_finanza_locale\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.944206Z", "completed_at": "2025-06-23T15:32:40.944206Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.959830Z", "completed_at": "2025-06-23T15:32:40.959830Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624284744262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.accepted_values_fact_bilanci_comunali_flag_dato_incompleto__True__False.523792949c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        flag_dato_incompleto as value_field,\n        count(*) as n_records\n\n    from \"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"\n    group by flag_dato_incompleto\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'True','False'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.959830Z", "completed_at": "2025-06-23T15:32:40.975467Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.975467Z", "completed_at": "2025-06-23T15:32:40.975467Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015636444091796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_fact_bilanci_comunali_anno.5113c37423", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect anno\nfrom \"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"\nwhere anno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.975467Z", "completed_at": "2025-06-23T15:32:40.991092Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:40.991092Z", "completed_at": "2025-06-23T15:32:40.991092Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_fact_bilanci_comunali_codice_comune.25af948f9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect codice_comune\nfrom \"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"\nwhere codice_comune is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:40.991092Z", "completed_at": "2025-06-23T15:32:41.006717Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:41.006717Z", "completed_at": "2025-06-23T15:32:41.006717Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03124856948852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_fact_bilanci_comunali_flag_dato_incompleto.6fa4dbe8fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect flag_dato_incompleto\nfrom \"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"\nwhere flag_dato_incompleto is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:41.028846Z", "completed_at": "2025-06-23T15:32:41.028846Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:41.028846Z", "completed_at": "2025-06-23T15:32:41.028846Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0065059661865234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_fact_bilanci_comunali_indicatore_affidabilita.c4e0c7be2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect indicatore_affidabilita\nfrom \"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"\nwhere indicatore_affidabilita is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:41.044475Z", "completed_at": "2025-06-23T15:32:41.044475Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:41.044475Z", "completed_at": "2025-06-23T15:32:41.044475Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015635251998901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_fact_bilanci_comunali_nome_comune.0197da85e7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nome_comune\nfrom \"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"\nwhere nome_comune is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:41.060111Z", "completed_at": "2025-06-23T15:32:41.075736Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:41.075736Z", "completed_at": "2025-06-23T15:32:41.075736Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0156252384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_fact_bilanci_comunali_saldo.fd60135e2c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect saldo\nfrom \"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"\nwhere saldo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:41.075736Z", "completed_at": "2025-06-23T15:32:41.091362Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:41.091362Z", "completed_at": "2025-06-23T15:32:41.091362Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015626192092895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_fact_bilanci_comunali_totale_entrate.e45632f2b4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect totale_entrate\nfrom \"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"\nwhere totale_entrate is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:41.091362Z", "completed_at": "2025-06-23T15:32:41.106986Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:41.106986Z", "completed_at": "2025-06-23T15:32:41.106986Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624046325683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_fact_bilanci_comunali_totale_spese.d05e516acc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect totale_spese\nfrom \"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"\nwhere totale_spese is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T15:32:41.106986Z", "completed_at": "2025-06-23T15:32:41.122610Z"}, {"name": "execute", "started_at": "2025-06-23T15:32:41.122610Z", "completed_at": "2025-06-23T15:32:41.122610Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624523162841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.test_indicatore_affidabilita_range_fact", "compiled": true, "compiled_code": "-- tests/marts/test_indicatore_affidabilita_range_fact.sql\nselect *\nfrom \"warehouse\".\"main_main_marts\".\"fact_bilanci_comunali\"\nwhere indicatore_affidabilita < 0\n   or indicatore_affidabilita > 100", "relation_name": null, "batch_results": null}], "elapsed_time": 1.3403575420379639, "args": {"compile": true, "strict_mode": false, "use_colors": true, "require_resource_names_without_spaces": false, "select": [], "require_batched_execution_for_custom_microbatch_strategy": false, "skip_nodes_if_on_run_start_fails": false, "indirect_selection": "eager", "static": false, "log_file_max_bytes": 10485760, "macro_debugging": false, "defer": false, "use_colors_file": true, "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "state_modified_compare_more_unrendered_values": false, "log_path": "C:\\Users\\Andrea\\Documents\\Mini Lakehouse Didattico\\dbt\\logs", "partial_parse": true, "project_dir": "C:\\Users\\Andrea\\Documents\\Mini Lakehouse Didattico\\dbt", "write_json": true, "log_format": "default", "show_resource_report": false, "version_check": true, "log_level_file": "debug", "empty_catalog": false, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "state_modified_compare_vars": false, "log_level": "info", "partial_parse_file_diff": true, "exclude": [], "warn_error_options": {"include": [], "exclude": []}, "quiet": false, "profiles_dir": "C:\\Users\\Andrea\\Documents\\Mini Lakehouse Didattico\\dbt", "printer_width": 80, "print": true, "require_nested_cumulative_type_params": false, "populate_cache": true, "send_anonymous_usage_stats": true, "favor_state": false, "source_freshness_run_project_hooks": false, "which": "generate", "cache_selected_only": false, "log_format_file": "debug", "invocation_command": "dbt docs generate", "static_parser": true}}