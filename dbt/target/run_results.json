{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-06-22T20:28:11.846193Z", "invocation_id": "99d963c8-bb2f-4aec-b39f-5a40216864f3", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.390067Z", "completed_at": "2025-06-22T20:28:11.409077Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.415873Z", "completed_at": "2025-06-22T20:28:11.415873Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025805950164794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.main_seeds.bilanci_comunali_sample", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.415873Z", "completed_at": "2025-06-22T20:28:11.422942Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.422942Z", "completed_at": "2025-06-22T20:28:11.422942Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0070683956146240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.main_seeds.bilanci_voci_sample", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.429930Z", "completed_at": "2025-06-22T20:28:11.436989Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.436989Z", "completed_at": "2025-06-22T20:28:11.436989Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014047622680664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.raw_bilanci", "compiled": true, "compiled_code": "--dbt/models/raw/raw_bilanci--\nSELECT * FROM \"warehouse\".\"main_seeds\".\"bilanci_comunali_sample\"", "relation_name": "\"warehouse\".\"main\".\"raw_bilanci\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.443658Z", "completed_at": "2025-06-22T20:28:11.450543Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.450543Z", "completed_at": "2025-06-22T20:28:11.450543Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006884574890136719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.stg_movimenti_bilancio", "compiled": true, "compiled_code": "\n\nselect\n    cast(codice_comune as int) as codice_comune,\n    nome_comune,\n    cast(anno as int) as anno,\n    codice_siope,\n    descrizione_siope,\n    tipologia,\n    cast(valore as bigint) as valore\nfrom \"warehouse\".\"main_seeds\".\"bilanci_voci_sample\"\nwhere codice_comune is not null and codice_siope is not null and valore is not null", "relation_name": "\"warehouse\".\"main_stg\".\"stg_movimenti_bilancio\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.450543Z", "completed_at": "2025-06-22T20:28:11.458806Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.458806Z", "completed_at": "2025-06-22T20:28:11.458806Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00826263427734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.stg_bilanci_comuni", "compiled": true, "compiled_code": "\n\nSELECT\n  codice_comune,\n  nome_comune,\n  anno,\n  entrate_tributarie,\n  spese_correnti,\n  entrate_tributarie - spese_correnti AS saldo\nFROM \"warehouse\".\"main\".\"raw_bilanci\"", "relation_name": "\"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.464634Z", "completed_at": "2025-06-22T20:28:11.471427Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.471427Z", "completed_at": "2025-06-22T20:28:11.471427Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006793022155761719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.core_movimenti_bilancio", "compiled": true, "compiled_code": "\n\nselect\n    codice_comune,\n    nome_comune,\n    anno,\n    codice_siope,\n    descrizione_siope,\n    tipologia,\n    valore\nfrom \"warehouse\".\"main_stg\".\"stg_movimenti_bilancio\"", "relation_name": "\"warehouse\".\"main_core\".\"core_movimenti_bilancio\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.471427Z", "completed_at": "2025-06-22T20:28:11.500033Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.500033Z", "completed_at": "2025-06-22T20:28:11.500033Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02860546112060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.core_bilanci_comuni", "compiled": true, "compiled_code": "SELECT\n    md5(cast(coalesce(cast(codice_comune as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(anno as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id_hash,\n    CAST(codice_comune AS INT) AS codice_comune,\n    nome_comune,\n    CAST(anno AS INT) AS anno,\n    CAST(entrate_tributarie AS BIGINT) AS entrate_tributarie,\n    CAST(spese_correnti AS BIGINT) AS spese_correnti\nFROM \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nWHERE \n    codice_comune IS NOT NULL\n    AND anno IS NOT NULL\n    AND entrate_tributarie IS NOT NULL\n    AND spese_correnti IS NOT NULL", "relation_name": "\"warehouse\".\"main_core\".\"core_bilanci_comuni\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.507302Z", "completed_at": "2025-06-22T20:28:11.521202Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.528073Z", "completed_at": "2025-06-22T20:28:11.528073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0245361328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_anno.a19cd8463e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect anno\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere anno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.528073Z", "completed_at": "2025-06-22T20:28:11.540297Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.542035Z", "completed_at": "2025-06-22T20:28:11.542035Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013962030410766602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_codice_comune.2f8b871ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect codice_comune\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere codice_comune is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.542035Z", "completed_at": "2025-06-22T20:28:11.555915Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.555915Z", "completed_at": "2025-06-22T20:28:11.555915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013879776000976562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_entrate_tributarie.4e6a97484e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect entrate_tributarie\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere entrate_tributarie is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.562878Z", "completed_at": "2025-06-22T20:28:11.569651Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.576748Z", "completed_at": "2025-06-22T20:28:11.576748Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02083301544189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_nome_comune.581593d156", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nome_comune\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere nome_comune is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.576748Z", "completed_at": "2025-06-22T20:28:11.590527Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.590527Z", "completed_at": "2025-06-22T20:28:11.590527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013779163360595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_saldo.17a4bbd521", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect saldo\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere saldo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.597622Z", "completed_at": "2025-06-22T20:28:11.604346Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.604346Z", "completed_at": "2025-06-22T20:28:11.604346Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013819217681884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_stg_bilanci_comuni_spese_correnti.ca2af9ffe3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect spese_correnti\nfrom \"warehouse\".\"main_stg\".\"stg_bilanci_comuni\"\nwhere spese_correnti is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.611643Z", "completed_at": "2025-06-22T20:28:11.620436Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.624169Z", "completed_at": "2025-06-22T20:28:11.624169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01450204849243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.agg_entrate_per_categoria", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        anno,\n        codice_comune,\n        nome_comune,\n        codice_siope,\n        descrizione_siope,\n        sum(valore) as totale_entrate\n    from \"warehouse\".\"main_core\".\"core_movimenti_bilancio\"\n    where tipologia = 'entrata'\n    group by 1, 2, 3, 4, 5\n)\n\nselect * from base", "relation_name": "\"warehouse\".\"main_marts\".\"agg_entrate_per_categoria\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.624169Z", "completed_at": "2025-06-22T20:28:11.631244Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.631244Z", "completed_at": "2025-06-22T20:28:11.631244Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007075309753417969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.audit_base", "compiled": true, "compiled_code": "SELECT\n    codice_comune,\n    anno,\n    COUNT(*) AS n_righe\nFROM \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\nGROUP BY codice_comune, anno\nHAVING COUNT(*) > 1\nORDER BY n_righe DESC", "relation_name": "\"warehouse\".\"main\".\"audit_base\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.638013Z", "completed_at": "2025-06-22T20:28:11.644964Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.644964Z", "completed_at": "2025-06-22T20:28:11.644964Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006951808929443359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.core_audit_flags", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select\n        codice_comune,\n        nome_comune,\n        anno,\n        entrate_tributarie,\n        spese_correnti,\n        entrate_tributarie - spese_correnti as saldo\n    from \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\n\n),\n\nlagged as (\n\n    select\n        codice_comune,\n        nome_comune,\n        anno,\n        entrate_tributarie,\n        spese_correnti,\n        saldo,\n        lag(entrate_tributarie) over (partition by codice_comune order by anno) as entrate_anno_prec,\n        lag(spese_correnti) over (partition by codice_comune order by anno) as spese_anno_prec\n    from base\n\n),\n\naudit as (\n\n    select\n        codice_comune,\n        nome_comune,\n        anno,\n        entrate_tributarie,\n        spese_correnti,\n        saldo,\n        entrate_anno_prec,\n        spese_anno_prec,\n        \n    case\n        when entrate_anno_prec is null then false\n        when abs(entrate_tributarie - entrate_anno_prec) / nullif(entrate_anno_prec, 0) > 0.5 then true\n        else false\n    end\n as flag_var_entrate,\n        \n    case\n        when spese_anno_prec is null then false\n        when abs(spese_correnti - spese_anno_prec) / nullif(spese_anno_prec, 0) > 0.5 then true\n        else false\n    end\n as flag_var_spese,\n\n        case when saldo < 0 then true else false end as flag_saldo_negativo,\n        case when entrate_tributarie is null or spese_correnti is null then true else false end as flag_valori_nulli\n    from lagged\n\n)\n\nselect * from audit", "relation_name": "\"warehouse\".\"main\".\"core_audit_flags\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.651721Z", "completed_at": "2025-06-22T20:28:11.651721Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.658844Z", "completed_at": "2025-06-22T20:28:11.658844Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007546663284301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.fact_bilanci_comunali", "compiled": true, "compiled_code": "SELECT\n    codice_comune,\n    nome_comune,\n    anno,\n    SUM(entrate_tributarie) AS totale_entrate,\n    SUM(spese_correnti) AS totale_spese,\n    SUM(entrate_tributarie - spese_correnti) AS saldo\nFROM \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\nGROUP BY codice_comune, nome_comune, anno\nORDER BY anno, codice_comune", "relation_name": "\"warehouse\".\"main_marts\".\"fact_bilanci_comunali\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.658844Z", "completed_at": "2025-06-22T20:28:11.665671Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.665671Z", "completed_at": "2025-06-22T20:28:11.665671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006826162338256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.check_anno_range", "compiled": true, "compiled_code": "SELECT *\nFROM \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\nWHERE anno < 2000 OR anno > 2025", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.665671Z", "completed_at": "2025-06-22T20:28:11.672598Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.672598Z", "completed_at": "2025-06-22T20:28:11.672598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006927967071533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.check_entrate_non_negative", "compiled": true, "compiled_code": "SELECT * FROM \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\nWHERE entrate_tributarie < 0", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.679546Z", "completed_at": "2025-06-22T20:28:11.686516Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.686516Z", "completed_at": "2025-06-22T20:28:11.686516Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013917684555053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.check_spese_non_negative", "compiled": true, "compiled_code": "SELECT * FROM \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\nWHERE spese_correnti < 0", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.686516Z", "completed_at": "2025-06-22T20:28:11.755905Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.755905Z", "completed_at": "2025-06-22T20:28:11.755905Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06938910484313965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.dbt_utils_not_empty_string_core_bilanci_comuni_nome_comune.2f66201c55", "compiled": true, "compiled_code": "\n\n    with\n    \n    all_values as (\n\n        select \n\n\n            trim(nome_comune) as nome_comune\n            \n        from \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\n\n    ),\n\n    errors as (\n\n        select * from all_values\n        where nome_comune = ''\n\n    )\n\n    select * from errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.762986Z", "completed_at": "2025-06-22T20:28:11.776818Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.776818Z", "completed_at": "2025-06-22T20:28:11.776818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013832330703735352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_anno.78df115c14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect anno\nfrom \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\nwhere anno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.776818Z", "completed_at": "2025-06-22T20:28:11.783680Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.783680Z", "completed_at": "2025-06-22T20:28:11.783680Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006861448287963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_codice_comune.9d6e36b0ed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect codice_comune\nfrom \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\nwhere codice_comune is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.790553Z", "completed_at": "2025-06-22T20:28:11.797608Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.797608Z", "completed_at": "2025-06-22T20:28:11.797608Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0070552825927734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.not_null_core_bilanci_comuni_nome_comune.d65879313b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nome_comune\nfrom \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\nwhere nome_comune is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.797608Z", "completed_at": "2025-06-22T20:28:11.804446Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.804446Z", "completed_at": "2025-06-22T20:28:11.804446Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0068378448486328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.test_core_bilanci_comuni", "compiled": true, "compiled_code": "select *\nfrom \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\nwhere anno < 2000", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.811402Z", "completed_at": "2025-06-22T20:28:11.818443Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.818443Z", "completed_at": "2025-06-22T20:28:11.818443Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013997077941894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main_seeds.unique_core_bilanci_comuni_codice_comune.3644546f79", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    codice_comune as unique_field,\n    count(*) as n_records\n\nfrom \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\nwhere codice_comune is not null\ngroup by codice_comune\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.825267Z", "completed_at": "2025-06-22T20:28:11.825267Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.832193Z", "completed_at": "2025-06-22T20:28:11.832193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013749837875366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.mart_audit_log", "compiled": true, "compiled_code": "\n\nwith audit as (\n\n    select *\n    from \"warehouse\".\"main\".\"core_audit_flags\"\n\n),\n\nanomalie as (\n\n    select *\n    from audit\n    where\n        flag_var_entrate = true\n        or flag_var_spese = true\n        or flag_saldo_negativo = true\n        or flag_valori_nulli = true\n\n)\n\nselect * from anomalie", "relation_name": "\"warehouse\".\"main\".\"mart_audit_log\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-22T20:28:11.832193Z", "completed_at": "2025-06-22T20:28:11.839104Z"}, {"name": "execute", "started_at": "2025-06-22T20:28:11.839104Z", "completed_at": "2025-06-22T20:28:11.839104Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006911277770996094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main_seeds.mart_finanza_locale", "compiled": true, "compiled_code": "\n\nwith bilanci as (\n\n    select\n        codice_comune,\n        nome_comune,\n        anno,\n        entrate_tributarie,\n        spese_correnti,\n        entrate_tributarie - spese_correnti as saldo\n    from \"warehouse\".\"main_core\".\"core_bilanci_comuni\"\n\n),\n\naudit as (\n\n    select\n        codice_comune,\n        anno,\n        flag_var_entrate,\n        flag_var_spese,\n        flag_saldo_negativo,\n        flag_valori_nulli,\n        -- almeno una anomalia\n        flag_var_entrate or flag_var_spese or flag_saldo_negativo or flag_valori_nulli as flag_anomalia\n    from \"warehouse\".\"main\".\"core_audit_flags\"\n\n),\n\nfinale as (\n\n    select\n        b.codice_comune,\n        b.nome_comune,\n        b.anno,\n        b.entrate_tributarie,\n        b.spese_correnti,\n        b.saldo,\n        coalesce(a.flag_anomalia, false) as flag_anomalia\n    from bilanci b\n    left join audit a\n      on b.codice_comune = a.codice_comune\n     and b.anno = a.anno\n\n)\n\nselect * from finale", "relation_name": "\"warehouse\".\"main_marts\".\"mart_finanza_locale\"", "batch_results": null}], "elapsed_time": 0.7962284088134766, "args": {"vars": {}, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "compile": true, "state_modified_compare_more_unrendered_values": false, "skip_nodes_if_on_run_start_fails": false, "static": false, "require_nested_cumulative_type_params": false, "which": "generate", "printer_width": 80, "log_path": "C:\\Users\\Andrea\\Documents\\Mini Lakehouse Didattico\\dbt\\logs", "source_freshness_run_project_hooks": false, "state_modified_compare_vars": false, "quiet": false, "populate_cache": true, "cache_selected_only": false, "write_json": true, "macro_debugging": false, "favor_state": false, "invocation_command": "dbt docs generate", "empty_catalog": false, "send_anonymous_usage_stats": true, "static_parser": true, "use_colors_file": true, "introspect": true, "partial_parse_file_diff": true, "print": true, "strict_mode": false, "select": [], "partial_parse": true, "use_colors": true, "profiles_dir": "C:\\Users\\Andrea\\Documents\\Mini Lakehouse Didattico\\dbt", "show_resource_report": false, "exclude": [], "defer": false, "log_format_file": "debug", "log_format": "default", "require_batched_execution_for_custom_microbatch_strategy": false, "require_explicit_package_overrides_for_builtin_materializations": true, "indirect_selection": "eager", "require_yaml_configuration_for_mf_time_spines": false, "log_level": "info", "log_level_file": "debug", "require_resource_names_without_spaces": false, "project_dir": "C:\\Users\\Andrea\\Documents\\Mini Lakehouse Didattico\\dbt"}}